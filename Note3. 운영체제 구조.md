## Note3. 운영체제 구조

> 운영체제를 책을 빌려주는 '도서관'이다.
>
> 시스템 리소스(책)를 필요로 하는 시민(응용 프로그램)에게 적절한 책을 찾아서 제공하며,
>
> 대여기간이 다 되면, 책을 '회수'한다.



- 운영체제는 응용프로그램이 요청하는 **메모리를 허가, 분배한다.**
- 운영체제는 응용프로그램이 요청하는 **CPU시간을 제공한다.**
- 운영체제는 응용프로그램이 요청하는 **IO DEVICES 사용을 허가/제어한다.**



***사용자 --(요청)--> 응용프로그램 --(요청)--> OS --(제어, 허가)--> 하드웨어 리소스***



- 운영체제는 사용자 인터페이스를 제공한다 : **쉘(Shell)**이라는 프로그램이 사용자의 요청을 받아 그 요청을 운영체제에 넘겨준다.

- ![image_1](/img/Note3_1.png)

  **ex) ls 명령어를 cmd창에 입력한다** : 운영체제에 '파일 리스트를 보여줘'라는 요청을 보내고, 그 결과 운영체제가 현재 경로의 파일 리스트를 cmd에 출력해준다.

  - Shell은 **터미널환경**과, **GUI환경**으로 구분된다.
  - Shell도 또한 하나의 **응용프로그램(Applciation)이다.**

  

- 운영체제는 **사용자뿐만 아니라 응용프로그램을 위해서도 인터페이스를 제공한다.**

  - 응용프로그램은 운영체제와 **프로그래밍 language**를 통하여 운영체제와 소통한다.

    ----> 특정 코드를 통해 **운영체제의 기능 사용을 요청한다.** 

  - OS가 제공하는 이러한 인터페이스를 **시스템 콜(System Call)**이라 한다.

    - 시스템콜은 직접 사용하기에 어려움이 있다 --> 일일히 세부사항을 직접 코딩하기가 어렵다.
    - 따라서 프로그래밍 언어들은 이 시스템콜을 편리하게 사용하기 위한 수단으로 여러가지 함수를 library 형태로 제공한다.
    - 운영체제가 응용프로그램에 제공하는 이 인터페이스를 **Application Programming Interface, API** 라고 한다.
    - **API**는 어떤 형태로 제공되는가 ? : **함수**의 형태로 제공하며, 일반적으로 **라이브러리**형태로 제공한다.

    ex) C언어의 open() 함수 : 파일을 연다. --> 파일은 저장매체(storage)에 있는 data이므로, **저장매체의 리소스를 제어할 수 있어야 한다(운영체제의 역할)**.

    ex2) C언어의 printf() 함수 : 모니터(IO device)에 문자열을 출력해야 한다.

    ​	(1) printf() 함수가 user mode에서 실행된다.

    ​	(2) printf() 함수의 실행은 stdio 라이브러리를 호출한다.

    ​	(3) stdio 라이브러리는 **시스템콜인 write() API 함수를 호출한다.**

    ​	(4) 실행의 흐름이 kernel mode로 전환되고, 커널이 호출을 실행하고 모니터에 글자를 출력한다.

    ​	(5) 실행의 흐름이 다시 user mode로 전환된다.

  - API는 함수의 집합이므로, 따라서 API는 **요청서의 집합**이라고 할 수 있다 : 응용프로그램이 필요로 하는 요청 종류(ex)파일 열기, 파일 닫기, 파일 쓰기, 화면 깜빡임.....)를 함수형태로 만들어 모아놓은 것이기 떄문이다.

  - 따라서, **Shell** 프로그램 또한 **API**를 통해 만들어졌음을 알 수 있다. Shell은 운영체제에 요청을 보내서 사용자가 필요한 결과를 얻어내게 하는 프로그램이므로, 운영체제의 API를 활용해야만 한다.

  > 응용프로그램은 OS가 제공하는 Interface(System Call)을 통해서만 자원을 사용할 수 있다.
  >
  > 운영체제는 응용프로그램이 자원을 활용할 수 있도록 함수 형태의 API를 제공한다. 
  >
  > 시스템 콜은 운영체제 기능을 호출하는 함수이고, API는 각 언어별(C, JAVA..) 운영체제 기능 호출 인터페이스 함수이다.



- 운영체제의 개발 순서
  - Kernel 개발 --> 시스템 콜 개발 --> 각 언어별 API 개발 --> Shell 개발 --> 응용프로그램 개발
  - 시스템 콜을 개발할 때, 시스템 콜을 정의한 표준이 존재한다 : 
    - (유닉스계열)POSIX API, 윈도우 API